import{j as t,c as Te,r as s,u as Ae,a as i,w as M,s as ye,d as ze,b as Me,o as Ee,P as Le}from"./index.734d3e29.js";import{P as Ue,m as he}from"./Page.14bcb723.js";import{B as E}from"./Button.5ba06c2b.js";import{T as y}from"./TextInput.2177e99f.js";import{a as je,u as Ve,D as we}from"./Divider.9afd48fe.js";import{A as $e}from"./index.esm.978a5bb0.js";import{S as ge}from"./Stepper.2fd6dacf.js";import{G as He}from"./Group.6e1f84ea.js";import"./Transition.8a437a01.js";function be(e,a,n){return Math.min(Math.max(e,a),n)}function Ke(){const{userAgent:e}=window.navigator,a=/(Macintosh)|(MacIntel)|(MacPPC)|(Mac68K)/i,n=/(Win32)|(Win64)|(Windows)|(WinCE)/i,d=/(iPhone)|(iPad)|(iPod)/i;return a.test(e)?"macos":d.test(e)?"ios":n.test(e)?"windows":/Android/i.test(e)?"android":/Linux/i.test(e)?"linux":"undetermined"}function We(){return typeof window<"u"?Ke():"undetermined"}const Qe=(e,a,n)=>Number.isInteger(e)&&e>=0&&a===0?"numeric":!Number.isInteger(e)&&e>=0&&a!==0?"decimal":Number.isInteger(e)&&e<0&&a===0||!Number.isInteger(e)&&e<0&&a!==0?n==="ios"?"text":"decimal":"numeric";function Ne({direction:e,size:a}){return t("svg",{style:{transform:e==="up"?"rotate(180deg)":void 0},width:a,height:a,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}const Pe={xs:20,sm:24,md:30,lg:34,xl:36};var Je=Te((e,{radius:a,size:n})=>({rightSection:{display:"flex",flexDirection:"column",height:"calc(100% - 2px)",margin:1,marginRight:1,overflow:"hidden",borderTopRightRadius:e.fn.radius(a),borderBottomRightRadius:e.fn.radius(a)},control:{margin:0,position:"relative",flex:"0 0 50%",display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",width:e.fn.size({size:n,sizes:Pe}),padding:0,WebkitTapHighlightColor:"transparent",borderBottom:`1px solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderLeft:`1px solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderTop:0,borderRight:0,backgroundColor:"transparent",marginRight:1,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,"&:not(:disabled):hover":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[0]},"&:disabled":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]}},controlUp:{},controlDown:{borderBottom:0}}));const Ge=Je;var Ze=Object.defineProperty,Xe=Object.defineProperties,Ye=Object.getOwnPropertyDescriptors,ce=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable,Se=(e,a,n)=>a in e?Ze(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,et=(e,a)=>{for(var n in a||(a={}))Ie.call(a,n)&&Se(e,n,a[n]);if(ce)for(var n of ce(a))_e.call(a,n)&&Se(e,n,a[n]);return e},tt=(e,a)=>Xe(e,Ye(a)),rt=(e,a)=>{var n={};for(var d in e)Ie.call(e,d)&&a.indexOf(d)<0&&(n[d]=e[d]);if(e!=null&&ce)for(var d of ce(e))a.indexOf(d)<0&&_e.call(e,d)&&(n[d]=e[d]);return n};const ot=e=>e||"",at=e=>{if(e==="-")return e;let a=e;a[0]==="."&&(a=`0${e}`);const n=parseFloat(a);if(!Number.isNaN(n))return e},Ce={xs:10,sm:14,md:16,lg:18,xl:20},nt={step:1,hideControls:!1,size:"sm",precision:0,noClampOnBlur:!1,formatter:ot,parser:at},Re=s.exports.forwardRef((e,a)=>{const n=Ae("NumberInput",nt,e),{disabled:d,value:p,onChange:_,decimalSeparator:S,min:m,max:l,startValue:h,step:q,stepHoldInterval:w,stepHoldDelay:L,onBlur:R,onFocus:X,onKeyDown:U,onKeyUp:Y,hideControls:j,radius:ee,variant:T,precision:f,defaultValue:F,noClampOnBlur:de,handlersRef:V,classNames:te,styles:A,size:z,rightSection:$,rightSectionWidth:H,formatter:re,parser:N,inputMode:K,unstyled:W}=n,Q=rt(n,["disabled","value","onChange","decimalSeparator","min","max","startValue","step","stepHoldInterval","stepHoldDelay","onBlur","onFocus","onKeyDown","onKeyUp","hideControls","radius","variant","precision","defaultValue","noClampOnBlur","handlersRef","classNames","styles","size","rightSection","rightSectionWidth","formatter","parser","inputMode","unstyled"]),{classes:B,cx:oe,theme:k}=Ge({radius:ee,size:z},{classNames:te,styles:A,unstyled:W,name:"NumberInput"}),[ae,ne]=s.exports.useState(!1),[P,I]=s.exports.useState(typeof p=="number"?p:typeof F=="number"?F:void 0),C=typeof p=="number"?p:P,[ie,g]=s.exports.useState(typeof C=="number"?C.toFixed(f):""),J=s.exports.useRef(),v=o=>{o!==P&&!Number.isNaN(o)&&(typeof _=="function"&&_(o),I(o))},se=(o="")=>{let c=typeof o=="number"?String(o):o;return S&&(c=c.replace(/\./g,S)),re(c)},G=o=>{let c=o;return S&&(c=c.replace(new RegExp(`\\${S}`,"g"),".")),N(c)},r=typeof m=="number"?m:-1/0,O=typeof l=="number"?l:1/0,b=s.exports.useRef();b.current=()=>{var o,c,u;if(P===void 0)v((o=h!=null?h:m)!=null?o:0),g((u=(c=h==null?void 0:h.toFixed(f))!=null?c:m==null?void 0:m.toFixed(f))!=null?u:"0");else{const x=be(P+q,r,O).toFixed(f);v(parseFloat(x)),g(x)}};const ue=s.exports.useRef();ue.current=()=>{var o,c,u;if(P===void 0)v((o=h!=null?h:m)!=null?o:0),g((u=(c=h==null?void 0:h.toFixed(f))!=null?c:m==null?void 0:m.toFixed(f))!=null?u:"0");else{const x=be(P-q,r,O).toFixed(f);v(parseFloat(x)),g(x)}},je(V,{increment:b.current,decrement:ue.current}),s.exports.useEffect(()=>{typeof p=="number"&&!ae&&(I(p),g(p.toFixed(f))),F===void 0&&p===void 0&&!ae&&(I(p),g(""))},[p]);const pe=L!==void 0&&w!==void 0,Z=s.exports.useRef(null),me=s.exports.useRef(0),D=()=>{Z.current&&window.clearTimeout(Z.current),Z.current=null,me.current=0},ve=o=>{o?b.current():ue.current(),me.current+=1},xe=o=>{if(ve(o),pe){const c=typeof w=="number"?w:w(me.current);Z.current=window.setTimeout(()=>xe(o),c)}},le=(o,c)=>{o.preventDefault(),J.current.focus(),ve(c),pe&&(Z.current=window.setTimeout(()=>xe(c),L))};s.exports.useEffect(()=>(D(),D),[]);const Fe=i("div",{className:B.rightSection,children:[t("button",{type:"button",tabIndex:-1,"aria-hidden":!0,disabled:C>=l,className:oe(B.control,B.controlUp),onPointerDown:o=>{le(o,!0)},onPointerUp:D,onPointerLeave:D,children:t(Ne,{size:k.fn.size({size:z,sizes:Ce}),direction:"up"})}),t("button",{type:"button",tabIndex:-1,"aria-hidden":!0,disabled:C<=m,className:oe(B.control,B.controlDown),onPointerDown:o=>{le(o,!1)},onPointerUp:D,onPointerLeave:D,children:t(Ne,{size:k.fn.size({size:z,sizes:Ce}),direction:"down"})})]}),Be=o=>{if(o.nativeEvent.isComposing)return;const u=o.target.value,x=G(u);g(x),u===""||u==="-"?v(void 0):u.trim()!==""&&!Number.isNaN(x)&&v(parseFloat(x))},ke=o=>{var c;if(o.target.value==="")g(""),v(void 0);else{let u=o.target.value;(u[0]===`${S}`||u[0]===".")&&(u=`0${u}`);const x=G(u),fe=be(parseFloat(x),r,O);Number.isNaN(fe)?g((c=C==null?void 0:C.toFixed(f))!=null?c:""):de||(g(fe.toFixed(f)),v(parseFloat(fe.toFixed(f))))}ne(!1),typeof R=="function"&&R(o)},Oe=o=>{ne(!0),typeof X=="function"&&X(o)},De=o=>{if(typeof U=="function"&&U(o),o.repeat&&pe&&(o.key==="ArrowUp"||o.key==="ArrowDown")){o.preventDefault();return}o.key==="ArrowUp"?le(o,!0):o.key==="ArrowDown"&&le(o,!1)},qe=o=>{typeof Y=="function"&&Y(o),(o.key==="ArrowUp"||o.key==="ArrowDown")&&D()};return t(y,{...tt(et({},Q),{variant:T,value:se(ie),disabled:d,ref:Ve(J,a),type:"text",onChange:Be,onBlur:ke,onFocus:Oe,onKeyDown:De,onKeyUp:qe,rightSection:$||(d||j||T==="unstyled"?null:Fe),rightSectionWidth:H||k.fn.size({size:z,sizes:Pe})+1,radius:ee,max:l,min:m,step:q,size:z,styles:A,classNames:te,inputMode:K||Qe(q,f,We()),__staticSelector:"NumberInput",unstyled:W})})});Re.displayName="@mantine/core/NumberInput";function it({book:e}){const a=M(l=>l.addItemQty),n=M(l=>l.subtractQty),d=M(l=>l.inputQty),p=M(l=>l.removeFromCart),_=l=>a(l),S=l=>parseInt(l.qty)>1?n(l):(ye({title:"Removed",message:"Item successfully removed on your cart.",color:"green"}),p(l)),m=(l,h)=>d(l,h);return i("div",{children:[i("div",{className:"grid grid-cols-4 place-items-center",children:[t("div",{className:"col-span-1 w-[70%] p-5",children:t("img",{src:e.thumbnail,alt:e.title})}),i("div",{className:"col-span-1 block",children:[t("p",{className:"text-center font-semibold",children:e.title}),t("p",{className:"text-center text-sm",children:e.authors})]}),i("p",{className:"font-semibold",children:["\u20B1 ",e.price]}),i("div",{className:"col-span-1 grid grid-cols-3 place-items-center",children:[t(E,{size:"xs",className:"text-2xl bg-red-600 border-2 border-red-600 hover:bg-primary  hover:text-red-600 transition-all",onClick:()=>S(e),children:"-"}),t(Re,{size:"xs",className:"",value:e.qty,hideControls:!0,onChange:l=>m(e,l)}),t(E,{size:"xs",className:"text-lg bg-red-600 border-2 border-red-600 hover:bg-primary  hover:text-red-600 transition-all",onClick:()=>_(e),children:"+"})]})]}),t(we,{my:"sm"})]})}function gt(){var C,ie,g,J,v,se,G;const e=ze(r=>r.user),a=M(r=>r.cart),n=M(r=>r.emptyCart),[d,p]=s.exports.useState((e==null?void 0:e.firstName)||""),[_,S]=s.exports.useState((e==null?void 0:e.lastName)||""),[m,l]=s.exports.useState((e==null?void 0:e.middleName)||""),[h,q]=s.exports.useState((e==null?void 0:e.email)||""),[w,L]=s.exports.useState((e==null?void 0:e.mobileNo)||""),[R,X]=s.exports.useState(((C=e==null?void 0:e.address)==null?void 0:C.houseNo)||((ie=e==null?void 0:e.address)==null?void 0:ie.unit)||""),[U,Y]=s.exports.useState(((g=e==null?void 0:e.address)==null?void 0:g.building)||""),[j,ee]=s.exports.useState(((J=e==null?void 0:e.address)==null?void 0:J.street)||""),[T,f]=s.exports.useState(((v=e==null?void 0:e.address)==null?void 0:v.barangay)||""),[F,de]=s.exports.useState(((se=e==null?void 0:e.address)==null?void 0:se.city)||""),[V,te]=s.exports.useState(((G=e==null?void 0:e.address)==null?void 0:G.region)||""),[A,z]=s.exports.useState(100),[$,H]=s.exports.useState(0),[re,N]=s.exports.useState(),[K,W]=s.exports.useState(!1),Q=Me(),B=()=>H(r=>r<1?r+1:r),oe=()=>H(r=>r>0?r-1:r),k=s.exports.useMemo(()=>a.map(r=>r.price*r.qty).reduce((r,O)=>r+O,0),[a]),ae=async()=>(await(await fetch("http://localhost:8080/v1/order",{method:"POST",headers:{"Content-Type":"Application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({orderItems:a.map(b=>({productId:b._id,productName:b.title,price:b.price,qty:b.qty}))})})).json()).id,ne=async r=>(await fetch(`http://localhost:8080/v1/order/${r.orderID}/capture`,{method:"POST",headers:{"Content-Type":"Application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({user:{firstName:e.firstName,lastName:e.lastName,middleName:e.middleName,email:e.email,mobileNo:w},shippingAddress:{unit:R,building:U,houseNo:R,street:j,barangay:T,city:F,region:V},orderItems:a.map(b=>({productId:b._id,productName:b.title,price:b.price,qty:b.qty})),deliveryFee:A,isPaid:!0,deliveryStatus:"pending",paypalOrderId:r.orderID})})).status===200?(n(),ye({title:"Success",message:"Placed Order Successfully.",color:"green"})):ye({title:"Error",message:"Sorry! Transaction failed.",color:"red"}),P=r=>{if(r.preventDefault(),!d)return N("First name is required.");if(!_)return N("Last name is required.");if(!h)return N("Email is required.");if(!w)return L("Mobile No is required.");if(!R)return N("Block/Lot/House/Unit Number is required.");if(!j)return N("Street is required.");if(!T)return N("Barangay is required.");if(!F)return N("Barangay is required");if(!V)return N("Region is Required");B()},I="bg-red-600 border-2 border-red-600 hover:bg-primary  hover:text-red-600 transition-all";return i(Ue,{children:[t("div",{className:"grid place-items-center h-screen max-w-4xl mx-auto px-4 pt-24",children:i("div",{className:"max-h-100  place-items-center w-full rounded-lg bg-primary shadow-sm p-5",children:[t("p",{className:"text-center font-bold text-2xl text-red-600",children:"Cart"}),a.length<1?i("p",{className:"p-10 text-md",children:["There are no items in your cart, ",t("button",{className:"font-bold text-red-600",onClick:()=>Q("/products"),children:"Click here to shop."})]}):i("form",{onSubmit:P,children:[i(ge,{active:$,onStepClick:H,breakpoint:"sm",size:"sm",color:"green",children:[t(ge.Step,{label:"Shipping",description:"Review Shipping Information",children:e?i(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[i("div",{className:"grid lg:grid-cols-3 gap-5 md:grid-cols-2 sm:grid-cols-1",children:[t(y,{placeholder:"John",label:"First Name",required:!0,value:d,onChange:r=>p(r.target.value)}),t(y,{placeholder:"Doe",label:"Last Name",required:!0,value:_,onChange:r=>S(r.target.value)}),t(y,{placeholder:"A",label:"Middle Name",value:m,onChange:r=>l(r.target.value)}),t(y,{placeholder:"john@example.com",type:"email",label:"Email",required:!0,value:h,onChange:r=>q(r.target.value)}),t(y,{placeholder:"09123456789",label:"Mobile Number",required:!0,value:w,onChange:r=>L(r.target.value)})]}),t(we,{my:"xl"}),i("div",{className:"grid lg:grid-cols-3 gap-5 md:grid-cols-2 sm:grid-cols-1",children:[t(y,{placeholder:"01H",label:"Block/Lot/House/Unit Number",required:!0,value:R,onChange:r=>X(r.target.value)}),t(y,{placeholder:"Green Residences",label:"Building",value:U,onChange:r=>Y(r.target.value)}),t(y,{placeholder:"Taft",label:"Street",required:!0,value:j,onChange:r=>ee(r.target.value)}),t(y,{placeholder:"San Juan",label:"Barangay",required:!0,value:T,onChange:r=>f(r.target.value)}),t(y,{placeholder:"Manila",label:"City",required:!0,value:F,onChange:r=>de(r.target.value)}),t(y,{placeholder:"NCR",label:"Region",required:!0,value:V,onChange:r=>te(r.target.value)})]})]}):i("p",{children:["Please Login ",t("button",{className:"font-bold text-red-600",onClick:()=>Q("/auth/login"),children:"here"})," to Review Shipping Information"]})}),t(ge.Step,{label:"Products",description:"Review Products Information",children:t(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i("div",{className:"grid lg:grid-cols-3 gap-5 lg:w-full",children:[i("div",{className:"lg:col-span-2 md:col-span-3",children:[a.length>0&&t(Ee,{children:a.map(r=>t(it,{book:r},r._id))}),i("div",{className:"font-semibold flex justify-between",children:[t("p",{children:"SubTotal"}),i("p",{children:["\u20B1 ",k]})]})]}),i("div",{className:"lg:col-span-1 md:col-span-3 m-5 grid",children:[t("div",{children:i("div",{className:"grid grid-cols-2",children:[t("p",{className:"pb-5",children:"Item Amount"}),i("p",{className:"font-semibold text-right pb-5",children:["\u20B1 ",k]}),t("p",{children:"Shipping Cost"}),i("p",{className:"font-semibold text-right",children:["\u20B1 ",A]})]})}),i("div",{className:"grid place-content-end ",children:[i("div",{className:"grid grid-cols-2 pb-5",children:[t("p",{children:"Total Amount"}),i("p",{className:"font-semibold text-right",children:["\u20B1 ",k+A]})]}),e?t(Le,{style:{layout:"vertical"},createOrder:ae,onApprove:ne}):t(E,{onClick:()=>Q("/auth/login"),className:I,children:"Login"})]})]})]})})})]}),e&&t("p",{className:"text-xs text-red-600",children:re&&re}),i(He,{position:"right",mt:"xl",children:[$>0&&t(E,{onClick:oe,className:I,children:"Back"}),$===0&&t(E,{className:I,type:"submit",children:"Next"})]})]})]})}),K?i(he.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"bg-primary p-5 pt-3 absolute bottom-1 right-1 rounded-md shadow-lg text-sm",children:[t("div",{className:"text-right",children:t("button",{className:"bg-red-600 border-2 border-red-600 hover:bg-primary  hover:text-red-600 transition-all rounded-xl text-white",onClick:()=>W(!K),children:t($e,{size:20})})}),t("p",{children:"Please use this payplal test account upon chekout"}),t("p",{children:"Email: "}),t("p",{className:"font-semibold",children:"sb-xhw6a20741718@personal.example.com"}),t("p",{children:"Password: "}),t("p",{className:"font-semibold",children:"rU?6KF0_"})]}):t("div",{className:"absolute bottom-1 right-1 rounded-md shadow-lg",onClick:()=>W(!K),children:t(E,{className:I,children:"Paypal Credentials"})})]})}export{gt as default};
