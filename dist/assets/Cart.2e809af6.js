import{j as n,c as Te,r as s,u as Le,a as i,w as M,s as ye,d as ze,b as Me,k as Ue,P as Ae}from"./index.ef387dcc.js";import{P as Ee,m as xe}from"./Page.ce2d1845.js";import{T as v,B as J}from"./TextInput.b2ededd3.js";import{a as je,u as Ve,D as we}from"./Divider.81bdbfbc.js";import{S as ge}from"./Stepper.1c6de78b.js";import{G as $e}from"./Group.3aef6afa.js";import"./use-id.df0464c7.js";import"./use-transition.16be7362.js";function he(e,o,a){return Math.min(Math.max(e,o),a)}function He(){const{userAgent:e}=window.navigator,o=/(Macintosh)|(MacIntel)|(MacPPC)|(Mac68K)/i,a=/(Win32)|(Win64)|(Windows)|(WinCE)/i,d=/(iPhone)|(iPad)|(iPod)/i;return o.test(e)?"macos":d.test(e)?"ios":a.test(e)?"windows":/Android/i.test(e)?"android":/Linux/i.test(e)?"linux":"undetermined"}function Ke(){return typeof window<"u"?He():"undetermined"}const We=(e,o,a)=>Number.isInteger(e)&&e>=0&&o===0?"numeric":!Number.isInteger(e)&&e>=0&&o!==0?"decimal":Number.isInteger(e)&&e<0&&o===0||!Number.isInteger(e)&&e<0&&o!==0?a==="ios"?"text":"decimal":"numeric";function Ne({direction:e,size:o}){return n("svg",{style:{transform:e==="up"?"rotate(180deg)":void 0},width:o,height:o,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}const Ie={xs:20,sm:24,md:30,lg:34,xl:36};var Qe=Te((e,{radius:o,size:a})=>({rightSection:{display:"flex",flexDirection:"column",height:"calc(100% - 2px)",margin:1,marginRight:1,overflow:"hidden",borderTopRightRadius:e.fn.radius(o),borderBottomRightRadius:e.fn.radius(o)},control:{margin:0,position:"relative",flex:"0 0 50%",display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",width:e.fn.size({size:a,sizes:Ie}),padding:0,WebkitTapHighlightColor:"transparent",borderBottom:`1px solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderLeft:`1px solid ${e.colorScheme==="dark"?e.colors.dark[4]:e.colors.gray[4]}`,borderTop:0,borderRight:0,backgroundColor:"transparent",marginRight:1,color:e.colorScheme==="dark"?e.colors.dark[0]:e.black,"&:not(:disabled):hover":{backgroundColor:e.colorScheme==="dark"?e.colors.dark[5]:e.colors.gray[0]},"&:disabled":{color:e.colorScheme==="dark"?e.colors.dark[3]:e.colors.gray[4]}},controlUp:{},controlDown:{borderBottom:0}}));const Je=Qe;var Ge=Object.defineProperty,Ze=Object.defineProperties,Xe=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,Se=(e,o,a)=>o in e?Ge(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,Ye=(e,o)=>{for(var a in o||(o={}))Pe.call(o,a)&&Se(e,a,o[a]);if(ie)for(var a of ie(o))Re.call(o,a)&&Se(e,a,o[a]);return e},et=(e,o)=>Ze(e,Xe(o)),tt=(e,o)=>{var a={};for(var d in e)Pe.call(e,d)&&o.indexOf(d)<0&&(a[d]=e[d]);if(e!=null&&ie)for(var d of ie(e))o.indexOf(d)<0&&Re.call(e,d)&&(a[d]=e[d]);return a};const rt=e=>e||"",ot=e=>{if(e==="-")return e;let o=e;o[0]==="."&&(o=`0${e}`);const a=parseFloat(o);if(!Number.isNaN(a))return e},Ce={xs:10,sm:14,md:16,lg:18,xl:20},nt={step:1,hideControls:!1,size:"sm",precision:0,noClampOnBlur:!1,formatter:rt,parser:ot},_e=s.exports.forwardRef((e,o)=>{const a=Le("NumberInput",nt,e),{disabled:d,value:p,onChange:R,decimalSeparator:S,min:m,max:l,startValue:g,step:O,stepHoldInterval:P,stepHoldDelay:U,onBlur:_,onFocus:G,onKeyDown:A,onKeyUp:Z,hideControls:E,radius:X,variant:k,precision:f,defaultValue:B,noClampOnBlur:se,handlersRef:j,classNames:Y,styles:D,size:q,rightSection:V,rightSectionWidth:$,formatter:ee,parser:N,inputMode:H,unstyled:te}=a,le=tt(a,["disabled","value","onChange","decimalSeparator","min","max","startValue","step","stepHoldInterval","stepHoldDelay","onBlur","onFocus","onKeyDown","onKeyUp","hideControls","radius","variant","precision","defaultValue","noClampOnBlur","handlersRef","classNames","styles","size","rightSection","rightSectionWidth","formatter","parser","inputMode","unstyled"]),{classes:C,cx:re,theme:K}=Je({radius:X,size:q},{classNames:Y,styles:D,unstyled:te,name:"NumberInput"}),[oe,T]=s.exports.useState(!1),[w,L]=s.exports.useState(typeof p=="number"?p:typeof B=="number"?B:void 0),I=typeof p=="number"?p:w,[ne,h]=s.exports.useState(typeof I=="number"?I.toFixed(f):""),W=s.exports.useRef(),b=r=>{r!==w&&!Number.isNaN(r)&&(typeof R=="function"&&R(r),L(r))},t=(r="")=>{let c=typeof r=="number"?String(r):r;return S&&(c=c.replace(/\./g,S)),ee(c)},z=r=>{let c=r;return S&&(c=c.replace(new RegExp(`\\${S}`,"g"),".")),N(c)},y=typeof m=="number"?m:-1/0,ce=typeof l=="number"?l:1/0,de=s.exports.useRef();de.current=()=>{var r,c,u;if(w===void 0)b((r=g!=null?g:m)!=null?r:0),h((u=(c=g==null?void 0:g.toFixed(f))!=null?c:m==null?void 0:m.toFixed(f))!=null?u:"0");else{const x=he(w+O,y,ce).toFixed(f);b(parseFloat(x)),h(x)}};const ue=s.exports.useRef();ue.current=()=>{var r,c,u;if(w===void 0)b((r=g!=null?g:m)!=null?r:0),h((u=(c=g==null?void 0:g.toFixed(f))!=null?c:m==null?void 0:m.toFixed(f))!=null?u:"0");else{const x=he(w-O,y,ce).toFixed(f);b(parseFloat(x)),h(x)}},je(j,{increment:de.current,decrement:ue.current}),s.exports.useEffect(()=>{typeof p=="number"&&!oe&&(L(p),h(p.toFixed(f))),B===void 0&&p===void 0&&!oe&&(L(p),h(""))},[p]);const pe=U!==void 0&&P!==void 0,Q=s.exports.useRef(null),me=s.exports.useRef(0),F=()=>{Q.current&&window.clearTimeout(Q.current),Q.current=null,me.current=0},ve=r=>{r?de.current():ue.current(),me.current+=1},be=r=>{if(ve(r),pe){const c=typeof P=="number"?P:P(me.current);Q.current=window.setTimeout(()=>be(r),c)}},ae=(r,c)=>{r.preventDefault(),W.current.focus(),ve(c),pe&&(Q.current=window.setTimeout(()=>be(c),U))};s.exports.useEffect(()=>(F(),F),[]);const Be=i("div",{className:C.rightSection,children:[n("button",{type:"button",tabIndex:-1,"aria-hidden":!0,disabled:I>=l,className:re(C.control,C.controlUp),onPointerDown:r=>{ae(r,!0)},onPointerUp:F,onPointerLeave:F,children:n(Ne,{size:K.fn.size({size:q,sizes:Ce}),direction:"up"})}),n("button",{type:"button",tabIndex:-1,"aria-hidden":!0,disabled:I<=m,className:re(C.control,C.controlDown),onPointerDown:r=>{ae(r,!1)},onPointerUp:F,onPointerLeave:F,children:n(Ne,{size:K.fn.size({size:q,sizes:Ce}),direction:"down"})})]}),Fe=r=>{if(r.nativeEvent.isComposing)return;const u=r.target.value,x=z(u);h(x),u===""||u==="-"?b(void 0):u.trim()!==""&&!Number.isNaN(x)&&b(parseFloat(x))},Oe=r=>{var c;if(r.target.value==="")h(""),b(void 0);else{let u=r.target.value;(u[0]===`${S}`||u[0]===".")&&(u=`0${u}`);const x=z(u),fe=he(parseFloat(x),y,ce);Number.isNaN(fe)?h((c=I==null?void 0:I.toFixed(f))!=null?c:""):se||(h(fe.toFixed(f)),b(parseFloat(fe.toFixed(f))))}T(!1),typeof _=="function"&&_(r)},ke=r=>{T(!0),typeof G=="function"&&G(r)},De=r=>{if(typeof A=="function"&&A(r),r.repeat&&pe&&(r.key==="ArrowUp"||r.key==="ArrowDown")){r.preventDefault();return}r.key==="ArrowUp"?ae(r,!0):r.key==="ArrowDown"&&ae(r,!1)},qe=r=>{typeof Z=="function"&&Z(r),(r.key==="ArrowUp"||r.key==="ArrowDown")&&F()};return n(v,{...et(Ye({},le),{variant:k,value:t(ne),disabled:d,ref:Ve(W,o),type:"text",onChange:Fe,onBlur:Oe,onFocus:ke,onKeyDown:De,onKeyUp:qe,rightSection:V||(d||E||k==="unstyled"?null:Be),rightSectionWidth:$||K.fn.size({size:q,sizes:Ie})+1,radius:X,max:l,min:m,step:O,size:q,styles:D,classNames:Y,inputMode:H||We(O,f,Ke()),__staticSelector:"NumberInput",unstyled:te})})});_e.displayName="@mantine/core/NumberInput";function at({book:e}){const o=M(l=>l.addItemQty),a=M(l=>l.subtractQty),d=M(l=>l.inputQty),p=M(l=>l.removeFromCart),R=l=>o(l),S=l=>parseInt(l.qty)>1?a(l):(ye({title:"Removed",message:"Item successfully removed on your cart.",color:"green"}),p(l)),m=(l,g)=>d(l,g);return i("div",{children:[i("div",{className:"grid grid-cols-4 place-items-center",children:[n("div",{className:"col-span-1 w-[70%] p-5",children:n("img",{src:e.thumbnail,alt:e.title})}),i("div",{className:"col-span-1 block",children:[n("p",{className:"text-center font-semibold",children:e.title}),n("p",{className:"text-center text-sm",children:e.authors})]}),i("p",{className:"font-semibold",children:["\u20B1 ",e.price.toLocaleString("en-US")]}),i("div",{className:"col-span-1 grid grid-cols-3 place-items-center",children:[n(J,{size:"xs",className:"text-2xl bg-red-600 border-2 border-red-600 hover:bg-primary  hover:text-red-600 transition-all",onClick:()=>S(e),children:"-"}),n(_e,{size:"xs",className:"",value:e.qty,hideControls:!0,onChange:l=>m(e,l)}),n(J,{size:"xs",className:"text-lg bg-red-600 border-2 border-red-600 hover:bg-primary  hover:text-red-600 transition-all",onClick:()=>R(e),children:"+"})]})]}),n(we,{my:"sm"})]})}function ft(){var w,L,I,ne,h,W,b;const e=ze(t=>t.user),o=M(t=>t.cart),a=M(t=>t.emptyCart),[d,p]=s.exports.useState((e==null?void 0:e.firstName)||""),[R,S]=s.exports.useState((e==null?void 0:e.lastName)||""),[m,l]=s.exports.useState((e==null?void 0:e.middleName)||""),[g,O]=s.exports.useState((e==null?void 0:e.email)||""),[P,U]=s.exports.useState((e==null?void 0:e.mobileNo)||""),[_,G]=s.exports.useState(((w=e==null?void 0:e.address)==null?void 0:w.houseNo)||((L=e==null?void 0:e.address)==null?void 0:L.unit)||""),[A,Z]=s.exports.useState(((I=e==null?void 0:e.address)==null?void 0:I.building)||""),[E,X]=s.exports.useState(((ne=e==null?void 0:e.address)==null?void 0:ne.street)||""),[k,f]=s.exports.useState(((h=e==null?void 0:e.address)==null?void 0:h.barangay)||""),[B,se]=s.exports.useState(((W=e==null?void 0:e.address)==null?void 0:W.city)||""),[j,Y]=s.exports.useState(((b=e==null?void 0:e.address)==null?void 0:b.region)||""),[D,q]=s.exports.useState(100),[V,$]=s.exports.useState(0),[ee,N]=s.exports.useState(),H=Me(),te=()=>$(t=>t<1?t+1:t),le=()=>$(t=>t>0?t-1:t),C=s.exports.useMemo(()=>o.map(t=>t.price*t.qty).reduce((t,z)=>t+z,0),[o]),re=async()=>(await(await fetch("http://localhost:8080/v1/order",{method:"POST",headers:{"Content-Type":"Application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({orderItems:o.map(y=>({productId:y._id,productName:y.title,price:y.price,qty:y.qty}))})})).json()).id,K=async t=>(await fetch(`http://localhost:8080/v1/order/${t.orderID}/capture`,{method:"POST",headers:{"Content-Type":"Application/json",Authorization:`Bearer ${localStorage.getItem("accessToken")}`},body:JSON.stringify({user:{firstName:e.firstName,lastName:e.lastName,middleName:e.middleName,email:e.email,mobileNo:P},shippingAddress:{unit:_,building:A,houseNo:_,street:E,barangay:k,city:B,region:j},orderItems:o.map(y=>({productId:y._id,productName:y.title,price:y.price,qty:y.qty})),deliveryFee:D,isPaid:!0,deliveryStatus:"pending",paypalOrderId:t.orderID})})).status===200?(a(),ye({title:"Success",message:"Placed Order Successfully.",color:"green"})):ye({title:"Error",message:"Sorry! Transaction failed.",color:"red"}),oe=t=>{if(t.preventDefault(),!d)return N("First name is required.");if(!R)return N("Last name is required.");if(!g)return N("Email is required.");if(!P)return U("Mobile No is required.");if(!_)return N("Block/Lot/House/Unit Number is required.");if(!E)return N("Street is required.");if(!k)return N("Barangay is required.");if(!B)return N("Barangay is required");if(!j)return N("Region is Required");te()},T="bg-red-600 border-2 border-red-600 hover:bg-primary  hover:text-red-600 transition-all";return n(Ee,{children:n("div",{className:"grid place-items-center h-screen max-w-4xl mx-auto px-4 pt-24",children:i("div",{className:"max-h-100  place-items-center w-full rounded-lg bg-primary shadow-sm p-5",children:[n("p",{className:"text-center font-bold text-2xl text-red-600",children:"Cart"}),o.length<1?i("p",{className:"p-10 text-md",children:["There are no items in your cart, ",n("button",{className:"font-bold text-red-600",onClick:()=>H("/products"),children:"Click here to shop."})]}):i("form",{onSubmit:oe,children:[i(ge,{active:V,onStepClick:$,breakpoint:"sm",size:"sm",color:"green",children:[n(ge.Step,{label:"Shipping",description:"Review Shipping Information",children:e?i(xe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[i("div",{className:"grid lg:grid-cols-3 gap-5 md:grid-cols-2 sm:grid-cols-1",children:[n(v,{placeholder:"John",label:"First Name",required:!0,value:d,onChange:t=>p(t.target.value)}),n(v,{placeholder:"Doe",label:"Last Name",required:!0,value:R,onChange:t=>S(t.target.value)}),n(v,{placeholder:"A",label:"Middle Name",value:m,onChange:t=>l(t.target.value)}),n(v,{placeholder:"john@example.com",type:"email",label:"Email",required:!0,value:g,onChange:t=>O(t.target.value)}),n(v,{placeholder:"09123456789",label:"Mobile Number",required:!0,value:P,onChange:t=>U(t.target.value)})]}),n(we,{my:"xl"}),i("div",{className:"grid lg:grid-cols-3 gap-5 md:grid-cols-2 sm:grid-cols-1",children:[n(v,{placeholder:"01H",label:"Block/Lot/House/Unit Number",required:!0,value:_,onChange:t=>G(t.target.value)}),n(v,{placeholder:"Green Residences",label:"Building",value:A,onChange:t=>Z(t.target.value)}),n(v,{placeholder:"Taft",label:"Street",required:!0,value:E,onChange:t=>X(t.target.value)}),n(v,{placeholder:"San Juan",label:"Barangay",required:!0,value:k,onChange:t=>f(t.target.value)}),n(v,{placeholder:"Manila",label:"City",required:!0,value:B,onChange:t=>se(t.target.value)}),n(v,{placeholder:"NCR",label:"Region",required:!0,value:j,onChange:t=>Y(t.target.value)})]})]}):i("p",{children:["Please Login ",n("button",{className:"font-bold text-red-600",onClick:()=>H("/auth/login"),children:"here"})," to Review Shipping Information"]})}),n(ge.Step,{label:"Products",description:"Review Products Information",children:n(xe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:i("div",{className:"grid lg:grid-cols-3 gap-5 lg:w-full",children:[i("div",{className:"lg:col-span-2 md:col-span-3",children:[o.length>0&&n(Ue,{children:o.map(t=>n(at,{book:t},t._id))}),i("div",{className:"font-semibold flex justify-between",children:[n("p",{children:"SubTotal"}),i("p",{children:["\u20B1 ",C.toLocaleString("en-US")]})]})]}),i("div",{className:"lg:col-span-1 md:col-span-3 m-5 grid",children:[n("div",{children:i("div",{className:"grid grid-cols-2",children:[n("p",{className:"pb-5",children:"Item Amount"}),i("p",{className:"font-semibold text-right pb-5",children:["\u20B1 ",C.toLocaleString("en-US")]}),n("p",{children:"Shipping Cost"}),i("p",{className:"font-semibold text-right",children:["\u20B1 ",D.toLocaleString("en-US")]})]})}),i("div",{className:"grid place-content-end ",children:[i("div",{className:"grid grid-cols-2 pb-5",children:[n("p",{children:"Total Amount"}),i("p",{className:"font-semibold text-right",children:["\u20B1 ",(C+D).toLocaleString("en-US")]})]}),e?n(Ae,{style:{layout:"vertical"},createOrder:re,onApprove:K}):n(J,{onClick:()=>H("/auth/login"),className:T,children:"Login"})]})]})]})})})]}),e&&n("p",{className:"text-xs text-red-600",children:ee&&ee}),i($e,{position:"right",mt:"xl",children:[V>0&&n(J,{onClick:le,className:T,children:"Back"}),V===0&&n(J,{className:T,type:"submit",children:"Next"})]})]})]})})})}export{ft as default};
